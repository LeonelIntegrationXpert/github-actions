<?xml version="1.0" encoding="UTF-8"?>
<!--
===============================================================================
  ðŸš€ MuleSoft Application POM (Child Project)
===============================================================================
  ðŸŽ¯ Objetivo:
    â€¢ Demonstrar como herdar configuraÃ§Ãµes do **Parent POM** (`common-pom-parent`).  
    â€¢ Centralizar as versÃµes de dependÃªncias via BOM (`common-bom`).  
    â€¢ Configurar build, testes (MUnit) e deploy no CloudHub 2.0 de forma simplificada.
===============================================================================
  âœï¸  Autor     : Leonel Dorneles Porto  
  ðŸ“§  Email     : leoneldornelesporto@outlook.com.br  
  â˜Žï¸  Telefone  : +55 53 99180-4869
===============================================================================
  ðŸ“š DescriÃ§Ã£o:
    - Este POM representa um **projeto Mule** (`mule-application`).
    - Herda do `common-pom-parent`, que por sua vez herda as versÃµes do `common-bom`.
    - Assim, sÃ³ definimos o mÃ­nimo (`artifactId`, `version` etc.) e deixamos 
      toda a lÃ³gica de build/test/deploy no Parent.
    - IncluÃ­mos algumas boas prÃ¡ticas, como o uso de <properties> para centralizar 
      valores que podem ser sobrescritos sem alterar diretamente as tags principais.
===============================================================================
-->

<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
                             https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <!-- ðŸ“Œ (1) VersÃ£o do Modelo do POM -->
    <modelVersion>4.0.0</modelVersion>

    <!--
    =============================================================================
     ðŸ”– (2) PROPRIEDADES GERAIS
       - Aqui concentramos valores que podem ser reutilizados ou sobrescritos.
       - Evita â€œhardcodeâ€ espalhado pelo POM.
       - Ajuste conforme sua organizaÃ§Ã£o.
    =============================================================================
    -->
    <properties>
        <!-- IdentificaÃ§Ã£o bÃ¡sica do projeto -->
        <project.groupId>37a4147b-4673-4cb6-b589-358074a13f8c</project.groupId>
        <project.artifactId>github-actions</project.artifactId>
        <project.version>3.2.14</project.version>

        <!-- VersÃ£o do Parent POM -->
        <common-pom-parent.version>1.0.0</common-pom-parent.version>

        <!-- URLs e Server IDs (caso queira manter como propriedades) -->
        <mulesoft.releases.repo.url>https://repository.mulesoft.org/releases/</mulesoft.releases.repo.url>
        <private.exchange.url>https://seu-repositorio-privado.com/maven</private.exchange.url>
        <private-exchange-repository.layout>default</private-exchange-repository.layout>
        <serverId>meu-server-id</serverId>

        <!-- Nome de deploy (pode ser ajustado para compor o finalName) -->
        <app.namingPattern>${project.artifactId}</app.namingPattern>
    </properties>

    <!-- 
    =============================================================================
     ðŸ”– (3) IdentificaÃ§Ã£o do Projeto Mule
       - Usamos as propriedades definidas acima para evitar duplicaÃ§Ãµes.
         (groupId, artifactId, version).
       - Ajuste os valores conforme sua organizaÃ§Ã£o.
    =============================================================================
    -->
    <groupId>${project.groupId}</groupId>
    <artifactId>${project.artifactId}</artifactId>
    <version>${project.version}.1</version>
    <packaging>mule-application</packaging>

    <name>github-actions</name>
    <description>
      Exemplo de projeto MuleSoft com build e deploy via GitHub Actions, 
      herda configs do parent-pom. 
      (Propriedades centralizadas para evitar hardcodes)
    </description>

    <!-- 
    =============================================================================
     ðŸ› (4) HeranÃ§a do Parent POM (`common-pom-parent`)
       - Herda as versÃµes do BOM (`common-bom`).
       - ConfiguraÃ§Ãµes de build, plugins e propriedades do CloudHub/Visualizer 
         jÃ¡ vÃªm prontas do Parent.
       - Caso precise sobrescrever algo especÃ­fico (ex.: versÃ£o de plugin), 
         basta adicionar aqui.
    =============================================================================
    -->
    <parent>
        <groupId>${project.groupId}</groupId>
        <artifactId>common-pom-parent</artifactId>
        <version>${common-pom-parent.version}</version>
    </parent>

    <!-- 
    =============================================================================
     ðŸ›  (5) BUILD
       - Geralmente deixamos apenas o essencial, pois plugins e configuraÃ§Ãµes 
         jÃ¡ vÃªm do Parent.
       - Exemplo: finalName, configuraÃ§Ãµes pontuais do Mule Maven Plugin etc.
    =============================================================================
    -->
    <build>
        <!-- ðŸ· Nome final do artefato -->
        <finalName>${app.namingPattern}</finalName>

        <plugins>
            <!-- 
                ðŸƒ Mule Maven Plugin: responsÃ¡vel por build e deploy no CloudHub.
                Herdamos a configuraÃ§Ã£o do Parent.
                Se quiser sobrescrever algo (ex.: vCores, workers, environmentName), 
                adiciona <configuration> aqui.
            -->
            <plugin>
                <groupId>org.mule.tools.maven</groupId>
                <artifactId>mule-maven-plugin</artifactId>
                <extensions>true</extensions>
            </plugin>

            <!-- 
                ðŸ“Š MUnit Maven Plugin: para testes e cobertura.
                Herdado do Parent, mas pode ser sobrescrito aqui se necessÃ¡rio 
                (ex.: versÃµes especÃ­ficas ou configuraÃ§Ã£o de relatÃ³rios).
            -->
            <plugin>
                <groupId>com.mulesoft.munit.tools</groupId>
                <artifactId>munit-maven-plugin</artifactId>
            </plugin>

            <!-- 
                ðŸ”§ Maven Clean Plugin: limpeza do projeto.
                Herdado do Parent/BOM, mas mantemos aqui para referÃªncias.
            -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-clean-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

    <!-- 
    =============================================================================
     ðŸ“¦ (6) DEPENDÃŠNCIAS
       - Com a BOM importada via Parent, nÃ£o Ã© necessÃ¡rio informar versÃµes.
       - Basta definir `groupId`, `artifactId` e `classifier` (quando necessÃ¡rio).
       - Todas as versÃµes ficam centralizadas no BOM herdado.
    =============================================================================
    -->
    <dependencies>
        <!-- ðŸ§ª Assertions para DataWeave (MUnit) -->
        <dependency>
            <groupId>org.mule.weave</groupId>
            <artifactId>assertions</artifactId>
            <scope>test</scope>
        </dependency>

        <!-- ðŸ§© Ferramentas do MUnit (mule-plugin) -->
        <dependency>
            <groupId>com.mulesoft.munit</groupId>
            <artifactId>munit-tools</artifactId>
            <classifier>mule-plugin</classifier>
            <scope>test</scope>
        </dependency>

        <!-- ðŸŒ Conector HTTP para Mule 4 -->
        <dependency>
            <groupId>org.mule.connectors</groupId>
            <artifactId>mule-http-connector</artifactId>
            <classifier>mule-plugin</classifier>
        </dependency>

        <!-- ðŸƒ Runner do MUnit (mule-plugin) -->
        <dependency>
            <groupId>com.mulesoft.munit</groupId>
            <artifactId>munit-runner</artifactId>
            <classifier>mule-plugin</classifier>
            <scope>test</scope>
        </dependency>

        <!-- ðŸ’» Conector de Sockets (opcional) -->
        <dependency>
            <groupId>org.mule.connectors</groupId>
            <artifactId>mule-sockets-connector</artifactId>
            <classifier>mule-plugin</classifier>
        </dependency>
    </dependencies>

    <!-- 
    =============================================================================
     ðŸŒŽ (7) REPOSITÃ“RIOS e PLUGIN REPOSITÃ“RIOS
       - Herdados do Parent BOM/Parent POM por padrÃ£o.
       - Aqui sobrescrevemos ou reforÃ§amos, caso necessÃ¡rio.
       - Se seu settings.xml tiver configuraÃ§Ã£o de <server>, referencie em 
         <distributionManagement> ou no plugin do Mule Maven.
    =============================================================================
    -->
    <pluginRepositories>
        <pluginRepository>
            <id>mulesoft-releases</id>
            <name>MuleSoft Releases Repository</name>
            <url>https://repository.mulesoft.org/releases/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </pluginRepository>
    </pluginRepositories>

    <repositories>

        <!-- ðŸŒ RepositÃ³rio PÃºblico do Anypoint Exchange v3 -->
        <repository>
            <id>anypoint-exchange-v3</id>
            <name>Anypoint Exchange v3 (Public)</name>
            <url>https://maven.anypoint.mulesoft.com/api/v3/maven</url>
        </repository>

        <!-- ðŸ¢ RepositÃ³rio de releases da MuleSoft -->
        <repository>
            <id>mulesoft-releases</id>
            <name>MuleSoft Releases Repository</name>
            <url>${mulesoft.releases.repo.url}</url>
        </repository>

        <!-- ðŸ” RepositÃ³rio Privado / Customizado -->
        <repository>
            <id>${serverId}</id>
            <name>Private Exchange repository</name>
            <url>${private.exchange.url}</url>
            <layout>${private-exchange-repository.layout}</layout>
        </repository>

    </repositories>

</project>
